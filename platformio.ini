[platformio]
default_envs = esp32s3_arduino_detection_test

; 共通設定
[env]
monitor_speed = 115200
lib_ldf_mode = deep+
# SDL2を使うnative環境向け: システムにSDL2がインストールされている前提
# macOS (Homebrew) の場合の典型的なフラグ。環境に合わせて要調整。
# brew install sdl2 してから、ターミナルで sdl2-config --cflags --libs を実行して確認できるよ！
lib_deps =
build_flags =

; ターゲットボード設定
[target_esp32s3_arduino]
platform = espressif32
board = esp32s3box
framework = arduino
build_flags =
  -DARDUINO_ESP32S3_DEV

# 新しく native ターゲットを追加！
[target_native]
platform = native
build_unflags = 
build_flags =
  -std=c++17 
  -Wall      
  !sdl2-config --cflags
link_flags =
  !sdl2-config --libs
lib_compat_mode = off 

; サンプル設定
[examples_detection_test]
build_src_filter = 
  +<*>
  +<../examples/detection_test/src/main.cpp>
build_flags =
  -D FLEXHAL_TEST_DETECTION

; 環境設定の組み合わせ
[env:esp32s3_arduino_detection_test]
extends = target_esp32s3_arduino
build_src_filter = ${examples_detection_test.build_src_filter}
build_flags =
  ${target_esp32s3_arduino.build_flags}
  ${examples_detection_test.build_flags}

# native 用のテスト環境を追加！
[env:native_detection_test]
extends = target_native, examples_detection_test
build_flags =
  -std=c++17
  -Wall
  ${target_native.build_flags}
  ${examples_detection_test.build_flags}

# Linker flags specific to this test environment (if any)
# link_flags =
#   ${target_native.link_flags}
#   ${examples_detection_test.link_flags}
